# Generated Behave Feature File from FlowSphere Configuration
# This file was auto-generated by FlowSphere MCP Server
# Configuration: {{ config.get('name', 'Unnamed Flow') }}
# Generated: {{ generation_timestamp }}

Feature: {{ config.get('name', 'API Test Flow') }}
  {% if config.get('description') %}{{ config.get('description') }}{% else %}Automated API test scenarios{% endif %}

{% for node in config.get('nodes', []) %}
  Scenario: {{ node.get('name', node.get('id', 'Unnamed scenario')) }}
    {% if node.get('condition') %}# Conditional execution: {{ node.condition }}
    {% endif %}
    {% if node.get('promptMessage') %}Given I have provided user input for "{{ node.id }}"
    {% endif %}
    {% if node.get('launchBrowser') %}And I have opened the browser
    {% endif %}
    When I execute {{ node.method }} request to "{{ node.url }}"{% if node.get('body') %} with body{% endif %}
{% if node.get('headers') %}
    And I set the following headers:
{% for key, value in node.headers.items() %}
      | {{ key }} | {{ value }} |
{% endfor %}
{% endif %}
{% if node.get('body') %}
    And I set the request body to:
      """
      {{ node.body | tojson(indent=6) }}
      """
{% endif %}
{% if node.get('validations') %}
{% for validation in node.validations %}
{% if validation.get('httpStatusCode') %}
    Then the response status code should be {{ validation.httpStatusCode }}
{% elif validation.get('field') %}
    And the response field "{{ validation.field }}" should be "{{ validation.value }}"
{% endif %}
{% endfor %}
{% else %}
    Then the response status code should be {{ config.get('defaults', {}).get('validations', [{}])[0].get('httpStatusCode', 200) }}
{% endif %}
{% if node.get('extractFields') %}
{% for field in node.extractFields %}
    And I extract "{{ field.jsonPath }}" as "{{ field.variableName }}"
{% endfor %}
{% endif %}

{% endfor %}
